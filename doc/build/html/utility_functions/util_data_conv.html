

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Conversion Group &mdash; embARC Machine Learning Library 2.0 2.00 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Helper Functions Group" href="util_help_func.html" />
    <link rel="prev" title="Utility Functions" href="utility_functions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> embARC Machine Learning Library 2.0
          

          
          </a>

          
            
            
              <div class="version">
                2.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whats_new/whats_new.html">What’s New in MLI 2.0 ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_api_data/mli_api_data.html">MLI API Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_kernels/mli_kernels.html">MLI Kernels (Operators)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_kernels/convolution_grp.html">Convolution Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_kernels/rec_fully_con_grp.html">Recurrent and Fully Connected Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_kernels/pooling_grp.html">Pooling Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_kernels/diverse_kernels_grp.html">Diverse Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_kernels/transform_grp.html">Transform (Activation) Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_kernels/elemw_grp.html">Element-wise Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_movement/data_movement.html">Data Movement</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="utility_functions.html">Utility Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data Conversion Group</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditions">Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#result">Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="util_help_func.html">Helper Functions Group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../platform_specific/platform_hint_sum.html">Platform Specific Details</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">embARC Machine Learning Library 2.0</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="utility_functions.html">Utility Functions</a> &raquo;</li>
        
      <li>Data Conversion Group</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/utility_functions/util_data_conv.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-conversion-group">
<span id="mli-convert"></span><h1>Data Conversion Group<a class="headerlink" href="#data-conversion-group" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This group contains functions which copy elements from the input tensor to the
output with data conversion according to the output tensor type parameters. The
functions convert the data from the source type to the destination type,
considering the quantization parameters of the source and destinations. This
includes a combination of:</p>
<blockquote>
<div><ul class="simple">
<li><p>Change of container size</p></li>
<li><p>Change of number of fractional bits or scale factor</p></li>
<li><p>Change of zero offset</p></li>
</ul>
</div></blockquote>
<p>Change of quantization axis of a per-axis quantized tensor is not allowed.
It means that if the input tensor is quantized per specific axis, then the output tensor
must have per-tensor quantization granularity or must be quantized across the same axis
as the input tensor.</p>
<p>The conversion function only supports the conversion between the MLI formats and
the conversion formats as listed in Figure <a class="reference internal" href="#f-data-conv-fmts"><span class="std std-ref">Data Conversion Formats</span></a>.</p>
<div class="figure align-center" id="id1">
<span id="f-data-conv-fmts"></span><img alt="Data Conversion Formats" src="../_images/data_conv_fmts.png" />
<p class="caption"><span class="caption-text">Data Conversion Formats</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>Rounding or saturation are used where needed to fit the data into the destination
container. Each output element is calculated from the corresponding input element in
the following way:</p>
<div class="math notranslate nohighlight">
\[x_{\text{dst}} = Sat\left( Round \left( \left( x_{\text{src}} - z_{\text{src}} \right)*\frac{s_{\text{src}}}{2^{n_{\text{src}}}}*\frac{2^{n_{\text{dst}}}}{s_{\text{dst}}} + z_{\text{dst}}\  \right) \right)\]</div>
<p>Where:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(x_{dst},x_{src}\)</span> - destination and source sample</p>
<p><span class="math notranslate nohighlight">\(z_{dst},z_{src}\)</span> = destination and source zeropoint (= 0
for formats other than signed asymmetric)</p>
<p><span class="math notranslate nohighlight">\(s_{dst},s_{src}\)</span> = destination and source scale factor (=
1 for formats other than signed asymmetric)</p>
<p><span class="math notranslate nohighlight">\(n_{dst},n_{src}\)</span> = destination and source number of
fractional bits (= 0 for float formats)</p>
<p><span class="math notranslate nohighlight">\(Sat\)</span> = saturation according to destination container size</p>
<p><span class="math notranslate nohighlight">\(Round\)</span> = rounding according to destination container size</p>
</div></blockquote>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Function prototype:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">mli_status</span> <span class="nf">mli_hlp_convert_tensor</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">mli_tensor</span><span class="o">*</span> <span class="n">src</span><span class="p">,</span>
    <span class="n">mli_tensor</span><span class="o">*</span> <span class="n">dst</span><span class="p">);</span>
</pre></div>
</div>
<p>For some platforms, there is a code size penalty if floating point operations are used.
Because the preceding function uses floating point operations even if no conversion from/to
float is needed by the application, the linker includes the floating point support code.
For that reason, the MLI API also includes a conversion specialization which only supports
fixed-point data types.</p>
<p>Ensure that you use this function in all places where it is known that neither the source nor
the destination tensor is a float tensor. It supports both signed asymmetric data formats and
fixed point data formats.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">mli_status</span> <span class="nf">mli_hlp_convert_tensor_safx</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">mli_tensor</span><span class="o">*</span> <span class="n">src</span><span class="p">,</span>
    <span class="n">mli_tensor</span><span class="o">*</span> <span class="n">dst</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="conditions">
<h2>Conditions<a class="headerlink" href="#conditions" title="Permalink to this headline">¶</a></h2>
<p>Ensure that you satisfy the following general conditions before calling the function:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> tensors must be valid (see <a class="reference internal" href="../mli_api_data/data_structures.html#mli-tnsr-struc"><span class="std std-ref">mli_tensor Structure Field Descriptions</span></a>)
and satisfy data requirements of the selected version of the kernel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> tensors must be of the same shapes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mem_stride</span></code> of the innermost dimension must be equal to 1 for all the tensors.</p></li>
</ul>
</div></blockquote>
<p>For <strong>sa8</strong> versions of the kernel, in addition to general conditions, ensure that you satisfy
the following quantization conditions before calling the function:</p>
<blockquote>
<div><ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> tensors are both quantized on per-axis level,
then they must share the same quantization axis (<code class="docutils literal notranslate"><span class="pre">in.el_params.sa.dim</span></code> = <code class="docutils literal notranslate"><span class="pre">out.el_params.sa.dim</span></code>).</p></li>
</ul>
</div></blockquote>
<p>Ensure that you satisfy the platform-specific conditions in addition to those listed above
(see the <a class="reference internal" href="../platform_specific/platform_hint_sum.html#platform-spec-chptr"><span class="std std-ref">Platform Specific Details</span></a> chapter).</p>
</div>
<div class="section" id="result">
<h2>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h2>
<p>These functions only modify the memory pointed by <code class="docutils literal notranslate"><span class="pre">out.data.mem</span></code> field.
It is assumed that all the other fields of <code class="docutils literal notranslate"><span class="pre">out</span></code> tensor are properly populated
to be used in calculations and are not modified by the kernel.</p>
<p>The kernel supports in-place computation for conversions with equal container size
(<code class="docutils literal notranslate"><span class="pre">fx8</span></code> to/from <code class="docutils literal notranslate"><span class="pre">sa8</span></code>, <code class="docutils literal notranslate"><span class="pre">sa8</span></code> to <code class="docutils literal notranslate"><span class="pre">sa8</span></code>, <code class="docutils literal notranslate"><span class="pre">fx16</span></code> to <code class="docutils literal notranslate"><span class="pre">fx16</span></code> and etc).
It means that <code class="docutils literal notranslate"><span class="pre">out</span></code> and <code class="docutils literal notranslate"><span class="pre">in</span></code> tensor structures
can point to the same memory with the same memory strides but without shift.
It can affect performance for some platforms.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only an exact overlap of starting address and memory stride of the <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code>
tensors is acceptable. Partial overlaps or in-place changing of container size
(<code class="docutils literal notranslate"><span class="pre">fx8</span></code> to <code class="docutils literal notranslate"><span class="pre">fx16</span></code> for example) result in undefined behavior.</p>
</div>
<p>Depending on the debug level (see section <a class="reference internal" href="../mli_api_data/error_codes.html#err-codes"><span class="std std-ref">Error Codes</span></a>), this function performs a parameter
check and returns the result as an <code class="docutils literal notranslate"><span class="pre">mli_status</span></code> code as described in section <a class="reference internal" href="../mli_api_data/data_structures.html#kernl-sp-conf"><span class="std std-ref">Kernel Specific Configuration Structures</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="util_help_func.html" class="btn btn-neutral float-right" title="Helper Functions Group" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="utility_functions.html" class="btn btn-neutral float-left" title="Utility Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Synopsys, Inc

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>