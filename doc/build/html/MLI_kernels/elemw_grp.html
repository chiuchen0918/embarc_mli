

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Element-wise Kernels Group &mdash; embARC Machine Learning Library 2.0 2.00 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Movement" href="../data_movement/data_movement.html" />
    <link rel="prev" title="L2 Normalization Prototype and Function List" href="trans_l2_norm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> embARC Machine Learning Library 2.0
          

          
          </a>

          
            
            
              <div class="version">
                2.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whats_new/whats_new.html">What’s New in MLI 2.0 ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_api_data/mli_api_data.html">MLI API Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="mli_kernels.html">MLI Kernels (Operators)</a></li>
<li class="toctree-l1"><a class="reference internal" href="convolution_grp.html">Convolution Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="rec_fully_con_grp.html">Recurrent and Fully Connected Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="pooling_grp.html">Pooling Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="diverse_kernels_grp.html">Diverse Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_grp.html">Transform (Activation) Kernels Group</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Element-wise Kernels Group</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#element-wise-operations-prototype-and-function-list">Element-wise Operations Prototype and Function List</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditions">Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#result">Result</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data_movement/data_movement.html">Data Movement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utility_functions/utility_functions.html">Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform_specific/platform_hint_sum.html">Platform Specific Details</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">embARC Machine Learning Library 2.0</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Element-wise Kernels Group</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/mli_kernels/elemw_grp.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="element-wise-kernels-group">
<span id="chap-element-wise"></span><h1>Element-wise Kernels Group<a class="headerlink" href="#element-wise-kernels-group" title="Permalink to this headline">¶</a></h1>
<div class="section" id="element-wise-operations-prototype-and-function-list">
<h2>Element-wise Operations Prototype and Function List<a class="headerlink" href="#element-wise-operations-prototype-and-function-list" title="Permalink to this headline">¶</a></h2>
<div class="section" id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h3>
<p>The Element-wise Group describes operations that are applied element-by-element
on two tensors of the same shape and return a tensor of the same shape. These kernels
can also be used for broadcasting a scalar value. One of the input tensors can be
a scalar tensor. In that case the operation is applied to the scalar value and each
element of the other tensor.</p>
<p><span class="math notranslate nohighlight">\(\text{out}_{i} = operation(\text{in}_{i}^{1},\ \text{in}_{i}^{2}\)</span>)</p>
<p><span class="math notranslate nohighlight">\(\text{out}_{i} = operation(\text{in}_{\text{scalar}}^{1},\ \text{in}_{i}^{2}\)</span>)</p>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<p>Kernels which implement Element-wise functions have the following prototype:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">mli_status</span> <span class="n">mli_krn_eltwise_</span><span class="o">&lt;</span><span class="n">operation</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">datatype</span><span class="o">&gt;</span> <span class="p">(</span>
   <span class="k">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">in1</span><span class="p">,</span>
   <span class="k">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">in2</span><span class="p">,</span>
   <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">out</span><span class="p">);</span>
</pre></div>
</div>
<span id="t-elw-data-conv"></span><table class="colwidths-auto docutils align-center" id="id1">
<caption><span class="caption-text">Element-wise Group Function Parameters</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">in1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mli_tensor</span> <span class="pre">*</span></code></p></td>
<td><p>[IN] Pointer to constant input tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">in2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mli_tensor</span> <span class="pre">*</span></code></p></td>
<td><p>[IN] Pointer to constant input tensor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">out</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mli_tensor</span> <span class="pre">*</span></code></p></td>
<td><p>[IN | OUT] Pointer to output tensor. Result is stored
here.</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto docutils align-center" id="id2">
<caption><span class="caption-text">List of Available Element-Wise Functions</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Function Name</strong></p></th>
<th class="head"><p><strong>Operation</strong></p></th>
<th class="head"><p><strong>in1 / in2 / out data format</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_add_sa8</span></code></p></td>
<td><p>Addition</p></td>
<td><p><strong>sa8</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_add_fx16</span></code></p></td>
<td><p>Addition</p></td>
<td><p><strong>fx16</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_sub_sa8</span></code></p></td>
<td><p>Subtract</p></td>
<td><p><strong>sa8</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_sub_fx16</span></code></p></td>
<td><p>Subtract</p></td>
<td><p><strong>fx16</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_min_sa8</span></code></p></td>
<td><p>Minimum</p></td>
<td><p><strong>sa8</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_min_fx16</span></code></p></td>
<td><p>Minimum</p></td>
<td><p><strong>fx16</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_max_sa8</span></code></p></td>
<td><p>Maximum</p></td>
<td><p><strong>sa8</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_max_fx16</span></code></p></td>
<td><p>Maximum</p></td>
<td><p><strong>fx16</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_mul_sa8</span></code></p></td>
<td><p>Multiply</p></td>
<td><p><strong>sa8</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_mul_fx16</span></code></p></td>
<td><p>Multiply</p></td>
<td><p><strong>fx16</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="conditions">
<h3>Conditions<a class="headerlink" href="#conditions" title="Permalink to this headline">¶</a></h3>
<p>Ensure that you satisfy the following general conditions before calling the function:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">in1</span></code>, <code class="docutils literal notranslate"><span class="pre">in2</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> tensors must be valid (see <a class="reference internal" href="../mli_api_data/data_structures.html#mli-tnsr-struc"><span class="std std-ref">mli_tensor Structure Field Descriptions</span></a>)
and satisfy data requirements of the specific version of the kernel.</p></li>
<li><p>Shapes of <code class="docutils literal notranslate"><span class="pre">in1</span></code>, <code class="docutils literal notranslate"><span class="pre">in2</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> tensors must be compatible,
which implies the following requirements:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">in1</span></code> and <code class="docutils literal notranslate"><span class="pre">in2</span></code> tensors must be of the same shape, or one of them can be a tensor-scalar
(see data field description in the Table <a class="reference internal" href="../mli_api_data/data_structures.html#mli-tnsr-struc"><span class="std std-ref">mli_tensor Structure Field Descriptions</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">out</span></code> tensors must be of the same shape as a non-scalar input tensor.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">mem_stride</span></code> of the innermost dimension must be equal to 1 for all the tensors.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_min_*</span></code> and <code class="docutils literal notranslate"><span class="pre">mli_krn_eltwise_max_*</span></code> functions,
the following additional restriction apply</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">in1</span></code>, <code class="docutils literal notranslate"><span class="pre">in2</span></code> tensors must have the same quantization parameters.
It means that <code class="docutils literal notranslate"><span class="pre">el_params</span></code> union of tensors must be the same.
For other elementwise functions this restriction is not applicable.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>For <strong>sa8</strong> versions of kernel, in addition to general conditions, ensure that you satisfy
the following quantization conditions before calling the function:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">in1</span></code>, <code class="docutils literal notranslate"><span class="pre">in2</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> tensors must be quantized on the tensor level. This implies
that each tensor contains a single scale factor and a single zero offset.</p></li>
<li><p>Zero offset of <code class="docutils literal notranslate"><span class="pre">in1</span></code>, <code class="docutils literal notranslate"><span class="pre">in2</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> tensors must be within [-128, 127] range.</p></li>
</ul>
</div></blockquote>
<p>Ensure that you satisfy the platform-specific conditions in addition to those listed above
(see the <a class="reference internal" href="../platform_specific/platform_hint_sum.html#platform-spec-chptr"><span class="std std-ref">Platform Specific Details</span></a> chapter).</p>
</div>
<div class="section" id="result">
<h3>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h3>
<p>These functions only modify the memory pointed by <code class="docutils literal notranslate"><span class="pre">out.data.mem</span></code> field.
It is assumed that all the other fields of <code class="docutils literal notranslate"><span class="pre">out</span></code> tensor are properly populated
to be used in calculations and are not modified by the kernel.</p>
<p>If the result of an operation is out of container’s range, it is saturated to the
container’s limit.</p>
<p>The kernel supports in-place computation. It means that output and input tensor structures
can point to the same memory with the same memory strides but without shift.
It can affect performance for some platforms.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only an exact overlap of starting address and memory stride of the input and output
tensors is acceptable. Partial overlaps result in undefined behavior.</p>
</div>
<p>Depending on the debug level (see section <a class="reference internal" href="../mli_api_data/error_codes.html#err-codes"><span class="std std-ref">Error Codes</span></a>) this function performs a parameter
check and returns the result as an <code class="docutils literal notranslate"><span class="pre">mli_status</span></code> code as described in section <a class="reference internal" href="../mli_api_data/data_structures.html#kernl-sp-conf"><span class="std std-ref">Kernel Specific Configuration Structures</span></a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../data_movement/data_movement.html" class="btn btn-neutral float-right" title="Data Movement" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="trans_l2_norm.html" class="btn btn-neutral float-left" title="L2 Normalization Prototype and Function List" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Synopsys, Inc

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>