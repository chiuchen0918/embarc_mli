

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Argmax Prototype and Function List &mdash; embARC Machine Learning Library 2.0 2.00 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Permute Prototype and Function List" href="div_permute.html" />
    <link rel="prev" title="Diverse Kernels Group" href="diverse_kernels_grp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> embARC Machine Learning Library 2.0
          

          
          </a>

          
            
            
              <div class="version">
                2.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whats_new/whats_new.html">What’s New in MLI 2.0 ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_api_data/mli_api_data.html">MLI API Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="mli_kernels.html">MLI Kernels (Operators)</a></li>
<li class="toctree-l1"><a class="reference internal" href="convolution_grp.html">Convolution Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="rec_fully_con_grp.html">Recurrent and Fully Connected Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="pooling_grp.html">Pooling Kernels Group</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="diverse_kernels_grp.html">Diverse Kernels Group</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Argmax Prototype and Function List</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditions">Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#result">Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="div_permute.html">Permute Prototype and Function List</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transform_grp.html">Transform (Activation) Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="elemw_grp.html">Element-wise Kernels Group</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_movement/data_movement.html">Data Movement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utility_functions/utility_functions.html">Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platform_specific/platform_hint_sum.html">Platform Specific Details</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">embARC Machine Learning Library 2.0</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="diverse_kernels_grp.html">Diverse Kernels Group</a> &raquo;</li>
        
      <li>Argmax Prototype and Function List</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/mli_kernels/div_argmax.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="argmax-prototype-and-function-list">
<span id="argmax-prot"></span><h1>Argmax Prototype and Function List<a class="headerlink" href="#argmax-prototype-and-function-list" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>This kernel returns the positions of maximum values across the whole tensor, or for each slice
across a dimension.</p>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Argmax functions have the following prototype:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">mli_status</span> <span class="n">mli_krn_argmax_</span><span class="o">&lt;</span><span class="n">data_format</span><span class="o">&gt;</span><span class="p">(</span>
   <span class="k">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span>
   <span class="k">const</span> <span class="n">mli_argmax_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">,</span>
   <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">out</span><span class="p">);</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">data_format</span></code> is one of the data formats listed in Table <a class="reference internal" href="../mli_api_data/data_formats.html#mli-data-fmts"><span class="std std-ref">MLI Data Formats</span></a> and the function
parameters are shown in the following table:</p>
<table class="colwidths-auto docutils align-center" id="id1">
<caption><span class="caption-text">Argmax Function Parameters</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mli_tensor</span> <span class="pre">*</span></code></p></td>
<td><p>[IN] Pointer to constant input tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cfg</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mli_argmax_cfg</span> <span class="pre">*</span></code></p></td>
<td><p>[IN] Pointer to argmax parameters structure.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">out</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mli_tensor</span> <span class="pre">*</span></code></p></td>
<td><p>[OUT] Pointer to output tensor.
Result is stored here</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">mli_argmax_cfg</span></code> is defined as:</p>
</div></blockquote>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
     <span class="kt">int32_t</span> <span class="n">axis</span><span class="p">;</span>
     <span class="kt">int32_t</span> <span class="n">topk</span><span class="p">;</span>
<span class="p">}</span> <span class="n">mli_argmax_cfg</span><span class="p">;</span>
</pre></div>
</div>
<span id="t-mli-argmax-cfg-desc"></span><table class="colwidths-auto docutils align-center" id="id2">
<caption><span class="caption-text">mli_argmax_cfg Structure Field Description</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Field name</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">axis</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int32_t</span></code></p></td>
<td><p>An axis along which the function is computed. Axis corresponds to
index of tensor’s dimension starting from 0. For instance, having feature
map in HWC layout, axis == 0 corresponds to H dimension. If axis &lt; 0,
the function is applied to the whole tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">top_k</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int32_t</span></code></p></td>
<td><p>Number of indexes per slice to be returned.</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto docutils align-center" id="id3">
<caption><span class="caption-text">List of Available Argmax Functions:</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Function Name</strong></p></th>
<th class="head"><p><strong>Details</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_argmax_sa8</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code> tensor data format: <strong>sa8</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mli_krn_argmax_fx16</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">in</span></code> tensors data format: <strong>fx16</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="conditions">
<h2>Conditions<a class="headerlink" href="#conditions" title="Permalink to this headline">¶</a></h2>
<p>Ensure that you satisfy the following general conditions before calling the function:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">in</span></code> tensor must be valid (see <a class="reference internal" href="../mli_api_data/data_structures.html#mli-tnsr-struc"><span class="std std-ref">mli_tensor Structure Field Descriptions</span></a>)
and satisfy data requirements of the selected version of the kernel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">out</span></code> tensor must be valid (see <a class="reference internal" href="../mli_api_data/data_structures.html#mli-tnsr-struc"><span class="std std-ref">mli_tensor Structure Field Descriptions</span></a>)
and satisfy the following requiremens:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">el_type</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">MLI_EL_SA_32</span></code></p></li>
<li><p>2-dimensional tensor (<code class="docutils literal notranslate"><span class="pre">rank</span></code> == 2) of shape (<code class="docutils literal notranslate"><span class="pre">dim_size</span></code>, <code class="docutils literal notranslate"><span class="pre">top_k</span></code>)  where <code class="docutils literal notranslate"><span class="pre">top_k</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">cfg.topk</span></code>
and <code class="docutils literal notranslate"><span class="pre">dim_size</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">in.shape[cfg.axis]</span></code> if <code class="docutils literal notranslate"><span class="pre">cfg.axis</span></code> &gt;= 0.
If <code class="docutils literal notranslate"><span class="pre">cfg.axis</span></code> &lt; 0 then <code class="docutils literal notranslate"><span class="pre">dim_size</span></code> is equal to 1</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">mem_stride</span></code> must satisfy the following statements:</p>
<blockquote>
<div><ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">out</span></code> tensor - memstride must reflect the shape,
e.g memory of these tensors must be contiguous.</p></li>
<li><p>For <code class="docutils literal notranslate"><span class="pre">in</span></code> tensor - memstride of the innermost dimension must be equal to 1.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">cfg</span></code> structure might be negative and must be less than <code class="docutils literal notranslate"><span class="pre">in</span></code> tensor rank.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">top_k</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">cfg</span></code> structure must satisfy the following requirements depending
on the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter of <code class="docutils literal notranslate"><span class="pre">cfg</span></code> structure:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> : <code class="docutils literal notranslate"><span class="pre">top_k</span></code> must be less or equal to the total number of elements in <code class="docutils literal notranslate"><span class="pre">in</span></code> tensor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">axis</span> <span class="pre">&gt;=</span> <span class="pre">0</span></code> : <code class="docutils literal notranslate"><span class="pre">top_k</span></code> must be less or equal to the total number of
elements in a single slice across the specified axis (that is the product of all
dimensions other than <code class="docutils literal notranslate"><span class="pre">cfg.axis</span></code>)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>For <strong>sa8</strong> versions of kernel, in addition to general conditions, ensure that you
satisfy the following condition before calling the function:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">in</span></code> tensor must be quantized on the tensor level. This implies that the tensor
contains a single scale factor and a single zero offset.</p></li>
</ul>
</div></blockquote>
<p>Ensure that you satisfy the platform-specific conditions in addition to those listed above
(see the <a class="reference internal" href="../platform_specific/platform_hint_sum.html#platform-spec-chptr"><span class="std std-ref">Platform Specific Details</span></a> chapter).</p>
</div>
<div class="section" id="result">
<h2>Result<a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h2>
<p>These functions modify:</p>
<blockquote>
<div><ul class="simple">
<li><p>Memory pointed by <code class="docutils literal notranslate"><span class="pre">out.data.mem</span></code> field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">el_params</span></code> field of <code class="docutils literal notranslate"><span class="pre">out</span></code> tensor.</p></li>
</ul>
</div></blockquote>
<p>It is assumed that all the other fields and structures are properly populated
to be used in calculations and are not modified by the kernel.</p>
<p><code class="docutils literal notranslate"><span class="pre">el_params</span></code> field is configured to reflect fully integer values
(zero_offset = 0,  scale = 1 and scale_frac_bits = 0).</p>
<p>Values in output tensor are 32 bit indexes. An index represents the target value position in the linear
memory pointed by input tensor data field. Hence, the value itself can be extracted from the array without
using the shape or memory stride fields of the input tensor.</p>
<div class="admonition tip">
<p class="admonition-title">Example</p>
<p>If <code class="docutils literal notranslate"><span class="pre">in</span></code> tensor has <code class="docutils literal notranslate"><span class="pre">sa8</span></code> type, value can be extracted just as <code class="docutils literal notranslate"><span class="pre">in.data.mem.pi8[id]</span></code> where <code class="docutils literal notranslate"><span class="pre">id</span></code>
is taken from <code class="docutils literal notranslate"><span class="pre">out</span></code> tensor using <code class="docutils literal notranslate"><span class="pre">out.data.mem.pi32[]</span></code> array. Memory strides and shape of <code class="docutils literal notranslate"><span class="pre">in</span></code>
tensor are already considered.</p>
</div>
<p>Depending on the debug level (see section <a class="reference internal" href="../mli_api_data/error_codes.html#err-codes"><span class="std std-ref">Error Codes</span></a>), this function performs a parameter
check and returns the result as an <code class="docutils literal notranslate"><span class="pre">mli_status</span></code> code as described in section <a class="reference internal" href="../mli_api_data/data_structures.html#kernl-sp-conf"><span class="std std-ref">Kernel Specific Configuration Structures</span></a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="div_permute.html" class="btn btn-neutral float-right" title="Permute Prototype and Function List" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="diverse_kernels_grp.html" class="btn btn-neutral float-left" title="Diverse Kernels Group" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, Synopsys, Inc

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>